/** estrada -v0.0.1
* Copyright (c) 2015 Weslley Araujo <weslleyaraujo20@gmail.com>
* Licensed MIT
*/

!function(a,b){function c(){this.routes={},this.bind(),this.setup()}c.prototype.bind=function(){b("hashchange",this.onHasChange.bind(this),!1)},c.prototype.onHasChange=function(){this.setup(),this.start()},c.prototype.register=function(a){return a.routes=a.routes||{},Object.keys(a.routes).forEach(function(b){this.routes[b]={callback:this.callbackHandler(a[a.routes[b]]),match:this.createMatch(b)}}.bind(this)),this},c.prototype.callbackHandler=function(a){return"function"==typeof a?a:function(){console.log("[router]: callback not found for this route!")}},c.prototype.getParameters=function(a){var b=[],c=this.options.hash.split("/");return a=this.prepareRoute(a).split("/"),a.forEach(function(a,d){a.match(/:/)&&b.push(c[d])}),b},c.prototype.createMatch=function(a){return a=this.prepareRoute(a),"/"===a?new RegExp(/^\s*$/):a.split("/").map(function(a){return a.match(/:/)?"[^\\/]*":a}).join("\\/")+"$"},c.prototype.prepareRoute=function(a){return"/"===a.charAt(0)?a:"/"+a},c.prototype.start=function(){var a;Object.keys(this.routes).forEach(function(b){a=this.routes[b],this.isMatch(this.options.hash,a.match)&&a.callback.apply(this,this.getParameters(b))}.bind(this))},c.prototype.isMatch=function(a,b){return!!a.match(b)},c.prototype.setup=function(){var a=document.location.hash.replace(/#/,"");this.options={hash:a}},a.Estrada=new c}(window,window.addEventListener);